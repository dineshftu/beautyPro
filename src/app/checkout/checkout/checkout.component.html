<div id="wrapper-content">

  <!-- start: filter section -->
  <div id="filter-section">
    <div class="form-group">
      <div class="ng-autocomplete">
        <ng-autocomplete [data]="customers" [searchKeyword]="keyword" placeHolder="Enter Customer Name"
          (selected)='selectCustomerEvent($event)' [itemTemplate]="itemTemplate" [notFoundTemplate]="notFoundTemplate">
        </ng-autocomplete>

        <ng-template #itemTemplate let-item>
          <a [innerHTML]="item.address"></a>
        </ng-template>

        <ng-template #notFoundTemplate let-notFound>
          <div [innerHTML]="notFound"></div>
        </ng-template>

      </div>
    </div>
  </div>

  <!--Header part-->
  <div class="inline-form">
    <div>
      Invoice
    </div>
  </div>

  <!-- start: treatment table section -->
  <div class="table-gen client-list">
    <!-- start: treatment table header -->
    <div class="table-header">
      <div class="row">
        <div> Treatment </div>
        <div> Price </div>
        <div> QTY </div>
        <div> Amount </div>
        <div> Therapist Name </div>
      </div>
      <!-- start: treatment table body -->
      <div id="table-body">
        <div class="table-row">
          <div class="row" *ngFor="let treatment of invoiceableTreatment; index as i">
            <div> {{treatment.treatmentName}} </div>
            <!-- <div> {{i + 1}} {{treatment.treatmentName}} </div> -->
            <div> {{treatment.price | currency : 'LKR'}} </div>
            <div> {{treatment.quantity}} </div>
            <div> {{treatment.amount | currency : 'LKR'}} </div>
            <div> {{treatment.employeeName}} </div>
          </div>
        </div>
      </div>
    </div>

    <!-- start: treatment total section -->
    <div class="checkout-total">
      <div class="checkout-total-row">
        <div class="total-label"> Sub Total </div>
        <div class="total-amount">{{treatmentSubTotal | currency : 'LKR'}}</div>
      </div>
      <div class="checkout-total-row">
        <div class="total-label"> Discount </div>
        <div class="total-amount"> {{discountAmount | currency : 'LKR'}} </div>
      </div>
      <div class="checkout-total-row">
        <div class="total-label"> Net Amount </div>
        <div class="total-amount"> {{treatmentNetAmount | currency : 'LKR'}} </div>
      </div>
      <div class="checkout-total-row">
        <div class="total-label"> Tax 6% </div>
        <div class="total-amount"> {{treatmentsTaxAmount | currency : 'LKR'}} </div>
      </div>
      <div class="checkout-total-row">
        <div class="total-label"> Due </div>
        <div class="total-amount"> {{treatmentDueAmount | currency : 'LKR'}} </div>
      </div>
    </div>

  </div>

  <!-- start: product table section -->

  <div class="table-gen client-list">
    <form name="form" (ngSubmit)="f.form.valid && addProduct()" #f="ngForm" novalidate>
      <div class="inline-form">
        <div class="form-group">
          <label>Product</label>
          <div class="ng-autocomplete">

            <ng-autocomplete #auto [data]="products" [searchKeyword]="keywordProduct" placeHolder="Enter Product Name"
              (selected)='selectProductEvent($event)' [itemTemplate]="itemTemplate"
              [notFoundTemplate]="notFoundTemplate" required>
            </ng-autocomplete>

            <ng-template #itemTemplate let-item>
              <a [innerHTML]="item.itemName"></a>
            </ng-template>

            <ng-template #notFoundTemplate2 let-notFound>
              <div [innerHTML]="notFound"></div>
            </ng-template>

            <div *ngIf="f.submitted && isProductNotSelected">
              <div class="error-msg">Product Name is required</div>
            </div>

          </div>
        </div>
        <div class="form-group form-amnt">
          <label>QTY</label>
          <input type="number" class="form-control" name="qty" (keypress)="numericOnly($event)"
            (input)="onQtyChange($event)" placeholder="Quantity..." [(ngModel)]='newInvoiceableProduct.quantity'
            required />

        </div>

        <div class="form-group">
          <label>Therapist Recommend</label>
          <div class="ng-autocomplete">

            <ng-autocomplete #auto [data]="employeesList" [searchKeyword]="keywordEmployee"
              placeHolder="Enter Employee Name" (selected)='selectEmployeeEvent($event)' [itemTemplate]="itemTemplate2"
              [notFoundTemplate]="notFoundTemplate2" required>
            </ng-autocomplete>

            <ng-template #itemTemplate2 let-item>
              <a [innerHTML]="item.name"></a>
            </ng-template>

            <ng-template #notFoundTemplate2 let-notFound>
              <div [innerHTML]="notFound"></div>
            </ng-template>

            <div *ngIf="f.submitted && isEmployeeNotSelected">
              <div class="error-msg">Employee Name is required</div>
            </div>

          </div>

        </div>
        <div>
          <button type="submit" class="btn-default">Add</button>
        </div>
      </div>

    </form>

    <div class="table-header">
      <div class="row">
        <div>Product </div>
        <div> Price </div>
        <div> QTY </div>
        <div> Amount </div>
        <div> Recommended By </div>
      </div>
    </div>
    <!-- start: product table body -->
    <div id="table-body">
      <div class="table-row">
        <div class="row" id="product{{i}}" *ngFor="let product of invoiceableProduct;let i=index">
          <div id="productName{{i}}"> {{product.productName}} </div>
          <div id="productPrice{{i}}"> {{product.price | currency : 'LKR'}} </div>
          <div id="productQuantity{{i}}"> {{product.quantity}} </div>
          <div id="productAmount{{i}}"> {{product?.price * product.quantity | currency : 'LKR'}} </div>
          <div id="productRec{{i}}"> {{product.recomendedByName}} </div>
        </div>
      </div>
    </div>

    <!-- start: product table total section -->
    <div class="checkout-total">
      <div class="checkout-total-row">
        <div class="total-label"> Sub Total </div>
        <div class="total-amount"> {{productSubTotal | currency : 'LKR'}} </div>
      </div>
      <div class="checkout-total-row">
        <div class="total-label"> Tax 6% </div>
        <div class="total-amount"> {{productsTaxAmount | currency : 'LKR'}} </div>
      </div>
      <div class="checkout-total-row">
        <div class="total-label"> Due </div>
        <div class="total-amount"> {{productDueAmount | currency : 'LKR'}} </div>
      </div>
    </div>
    <!--start Sub Total section-->
    <div class="checkout-total">
      <div class="checkout-total-row">
        <div class="total-label"> Bill Sub </div>
        <div class="total-amount"> {{treatmentSubTotal + productSubTotal | currency : 'LKR'}}} </div>
      </div>
      <div class="checkout-total-row">
        <div class="total-label"> Discount</div>
        <div class="total-amount"> {{discountAmount | currency : 'LKR'}}} </div>
      </div>
      <div class="checkout-total-row">
        <div class="total-label"> Net Amount </div>
        <div class="total-amount"> {{treatmentNetAmount + productSubTotal | currency : 'LKR'}}} </div>
      </div>
      <div class="checkout-total-row">
        <div class="total-label"> Tax 6% </div>
        <div class="total-amount"> {{treatmentsTaxAmount + productsTaxAmount | currency : 'LKR'}}} </div>
      </div>
      <div class="checkout-total-row">
        <div class="total-label"> Due Total </div>
        <div class="total-amount"> {{treatmentDueAmount + productDueAmount | currency : 'LKR'}}} </div>
      </div>
    </div>
  </div>

</div>